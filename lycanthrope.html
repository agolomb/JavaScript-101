<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Lycanthropeâ€™s log</title>
  </head>
  <body>
    <script>
      var JOURNAL = [
        { events: ["carrot", "exercise", "weekend"], squirrel: false },
        {
          events: [
            "bread",
            "pudding",
            "brushed teeth",
            "weekend",
            "touched tree",
          ],
          squirrel: false,
        },
        {
          events: ["carrot", "nachos", "brushed teeth", "cycling", "weekend"],
          squirrel: false,
        },
        {
          events: [
            "brussel sprouts",
            "ice cream",
            "brushed teeth",
            "computer",
            "weekend",
          ],
          squirrel: false,
        },
        {
          events: [
            "potatoes",
            "candy",
            "brushed teeth",
            "exercise",
            "weekend",
            "dentist",
          ],
          squirrel: false,
        },
        {
          events: [
            "brussel sprouts",
            "pudding",
            "brushed teeth",
            "running",
            "weekend",
          ],
          squirrel: false,
        },
        {
          events: [
            "pizza",
            "brushed teeth",
            "computer",
            "work",
            "touched tree",
          ],
          squirrel: false,
        },
        {
          events: ["bread", "beer", "brushed teeth", "cycling", "work"],
          squirrel: false,
        },
        { events: ["cauliflower", "brushed teeth", "work"], squirrel: false },
        {
          events: ["pizza", "brushed teeth", "cycling", "work"],
          squirrel: false,
        },
        {
          events: ["lasagna", "nachos", "brushed teeth", "work"],
          squirrel: false,
        },
        {
          events: ["brushed teeth", "weekend", "touched tree"],
          squirrel: false,
        },
        {
          events: ["lettuce", "brushed teeth", "television", "weekend"],
          squirrel: false,
        },
        { events: ["spaghetti", "brushed teeth", "work"], squirrel: false },
        { events: ["brushed teeth", "computer", "work"], squirrel: false },
        {
          events: ["lettuce", "nachos", "brushed teeth", "work"],
          squirrel: false,
        },
        {
          events: ["carrot", "brushed teeth", "running", "work"],
          squirrel: false,
        },
        { events: ["brushed teeth", "work"], squirrel: false },
        { events: ["cauliflower", "reading", "weekend"], squirrel: false },
        { events: ["bread", "brushed teeth", "weekend"], squirrel: false },
        {
          events: ["lasagna", "brushed teeth", "exercise", "work"],
          squirrel: false,
        },
        {
          events: ["spaghetti", "brushed teeth", "reading", "work"],
          squirrel: false,
        },
        {
          events: [
            "carrot",
            "ice cream",
            "brushed teeth",
            "television",
            "work",
          ],
          squirrel: false,
        },
        { events: ["spaghetti", "nachos", "work"], squirrel: false },
        {
          events: [
            "cauliflower",
            "ice cream",
            "brushed teeth",
            "cycling",
            "work",
          ],
          squirrel: false,
        },
        {
          events: ["spaghetti", "peanuts", "computer", "weekend"],
          squirrel: true,
        },
        {
          events: [
            "potatoes",
            "ice cream",
            "brushed teeth",
            "computer",
            "weekend",
          ],
          squirrel: false,
        },
        {
          events: ["potatoes", "ice cream", "brushed teeth", "work"],
          squirrel: false,
        },
        {
          events: ["peanuts", "brushed teeth", "running", "work"],
          squirrel: false,
        },
        { events: ["potatoes", "exercise", "work"], squirrel: false },
        { events: ["pizza", "ice cream", "computer", "work"], squirrel: false },
        { events: ["lasagna", "ice cream", "work"], squirrel: false },
        {
          events: ["cauliflower", "candy", "reading", "weekend"],
          squirrel: false,
        },
        {
          events: ["lasagna", "nachos", "brushed teeth", "running", "weekend"],
          squirrel: false,
        },
        { events: ["potatoes", "brushed teeth", "work"], squirrel: false },
        { events: ["carrot", "work"], squirrel: false },
        { events: ["pizza", "beer", "work", "dentist"], squirrel: false },
        { events: ["lasagna", "pudding", "cycling", "work"], squirrel: false },
        {
          events: ["spaghetti", "brushed teeth", "reading", "work"],
          squirrel: false,
        },
        {
          events: ["spaghetti", "pudding", "television", "weekend"],
          squirrel: false,
        },
        {
          events: ["bread", "brushed teeth", "exercise", "weekend"],
          squirrel: false,
        },
        { events: ["lasagna", "peanuts", "work"], squirrel: true },
        { events: ["pizza", "work"], squirrel: false },
        { events: ["potatoes", "exercise", "work"], squirrel: false },
        { events: ["brushed teeth", "exercise", "work"], squirrel: false },
        {
          events: ["spaghetti", "brushed teeth", "television", "work"],
          squirrel: false,
        },
        { events: ["pizza", "cycling", "weekend"], squirrel: false },
        { events: ["carrot", "brushed teeth", "weekend"], squirrel: false },
        {
          events: ["carrot", "beer", "brushed teeth", "work"],
          squirrel: false,
        },
        { events: ["pizza", "peanuts", "candy", "work"], squirrel: true },
        {
          events: ["carrot", "peanuts", "brushed teeth", "reading", "work"],
          squirrel: false,
        },
        {
          events: ["potatoes", "peanuts", "brushed teeth", "work"],
          squirrel: false,
        },
        {
          events: ["carrot", "nachos", "brushed teeth", "exercise", "work"],
          squirrel: false,
        },
        {
          events: [
            "pizza",
            "peanuts",
            "brushed teeth",
            "television",
            "weekend",
          ],
          squirrel: false,
        },
        {
          events: ["lasagna", "brushed teeth", "cycling", "weekend"],
          squirrel: false,
        },
        {
          events: [
            "cauliflower",
            "peanuts",
            "brushed teeth",
            "computer",
            "work",
            "touched tree",
          ],
          squirrel: false,
        },
        {
          events: ["lettuce", "brushed teeth", "television", "work"],
          squirrel: false,
        },
        {
          events: ["potatoes", "brushed teeth", "computer", "work"],
          squirrel: false,
        },
        { events: ["bread", "candy", "work"], squirrel: false },
        { events: ["potatoes", "nachos", "work"], squirrel: false },
        {
          events: ["carrot", "pudding", "brushed teeth", "weekend"],
          squirrel: false,
        },
        {
          events: [
            "carrot",
            "brushed teeth",
            "exercise",
            "weekend",
            "touched tree",
          ],
          squirrel: false,
        },
        { events: ["brussel sprouts", "running", "work"], squirrel: false },
        { events: ["brushed teeth", "work"], squirrel: false },
        {
          events: ["lettuce", "brushed teeth", "running", "work"],
          squirrel: false,
        },
        { events: ["candy", "brushed teeth", "work"], squirrel: false },
        {
          events: ["brussel sprouts", "brushed teeth", "computer", "work"],
          squirrel: false,
        },
        { events: ["bread", "brushed teeth", "weekend"], squirrel: false },
        {
          events: ["cauliflower", "brushed teeth", "weekend"],
          squirrel: false,
        },
        {
          events: ["spaghetti", "candy", "television", "work", "touched tree"],
          squirrel: false,
        },
        {
          events: ["carrot", "pudding", "brushed teeth", "work"],
          squirrel: false,
        },
        { events: ["lettuce", "brushed teeth", "work"], squirrel: false },
        {
          events: ["carrot", "ice cream", "brushed teeth", "cycling", "work"],
          squirrel: false,
        },
        { events: ["pizza", "brushed teeth", "work"], squirrel: false },
        {
          events: ["spaghetti", "peanuts", "exercise", "weekend"],
          squirrel: true,
        },
        {
          events: ["bread", "beer", "computer", "weekend", "touched tree"],
          squirrel: false,
        },
        { events: ["brushed teeth", "running", "work"], squirrel: false },
        {
          events: [
            "lettuce",
            "peanuts",
            "brushed teeth",
            "work",
            "touched tree",
          ],
          squirrel: false,
        },
        {
          events: ["lasagna", "brushed teeth", "television", "work"],
          squirrel: false,
        },
        {
          events: ["cauliflower", "brushed teeth", "running", "work"],
          squirrel: false,
        },
        {
          events: ["carrot", "brushed teeth", "running", "work"],
          squirrel: false,
        },
        { events: ["carrot", "reading", "weekend"], squirrel: false },
        { events: ["carrot", "peanuts", "reading", "weekend"], squirrel: true },
        {
          events: ["potatoes", "brushed teeth", "running", "work"],
          squirrel: false,
        },
        {
          events: ["lasagna", "ice cream", "work", "touched tree"],
          squirrel: false,
        },
        {
          events: [
            "cauliflower",
            "peanuts",
            "brushed teeth",
            "cycling",
            "work",
          ],
          squirrel: false,
        },
        {
          events: ["pizza", "brushed teeth", "running", "work"],
          squirrel: false,
        },
        { events: ["lettuce", "brushed teeth", "work"], squirrel: false },
        {
          events: ["bread", "brushed teeth", "television", "weekend"],
          squirrel: false,
        },
        {
          events: ["cauliflower", "peanuts", "brushed teeth", "weekend"],
          squirrel: false,
        },
      ];
      /*We have our raw data. Now let's think about what we want to test. How many situations can occur when look for correlation with a certain event?
Is the a correlation whenever we eat pizza?
1. No pizza and No squirrel
2. Yes pizza and No squirrel
3. No pizza and Yes squirrel
4. Yes Pizza and Yes squirrel
We want to know how many times each of these 4 situations occur.
*/
      /* The goal is to produce an array [76, 9, 4, 1] like this for an event we choose to test the correlation.
fX tableFor does exactly that. We pass it an event "pizza" and an array "JOURNAL"
It returns the count of each of the 4 scenario we test in the PHI equation for correlation.
  */
      function tableFor(event, journal) {
        let table = [0, 0, 0, 0]; //initialize our little table to store each 4 scenarios
        //Then a classic for loop to analyze our JOURNAL array
        for (let i = 0; i < journal.length; i++) {
          let entry = journal[i], //initialize each entry with our events and the squirrel boolean
            index = 0; // We start the first scenario (position 0 on our table), No Squirrel && No Pizza
          //THEN we check for "pizza"
          if (entry.events.includes(event)) index += 1; //Using Dot Notation, if events in each entry INCLUDES the event we pass it, increment the index so that we're on the second scenario No Squirrel && Yes Pizza
          //THEN, if that isn't true...we go to the next if stmt
          if (entry.squirrel) index += 2; // Using Dot Notation, if the squirrel in each entry IS TRUE, increment the index by 2 to be in the 3rd scenario Yes Squirrel && No Pizza
          //THEN, if that isn't true...we go the final scenario
          table[index] += 1; //we add 1 to the 4th scenario because Pizza was YES && Squirrel was YES.
        }
        return table;
      }
      console.log(tableFor("pizza", JOURNAL));
      //Now we can build the math that calculates PHI correlation

      function phi(table) {
        //We pass our 4 scenarios table array to our PHI function
        //In the return we target each item in the array by referencing it's index
        return (
          (table[3] * table[0] - table[2] * table[1]) /
          Math.sqrt(
            (table[2] + table[3]) *
              (table[0] + table[1]) *
              (table[1] + table[3]) *
              (table[0] + table[2])
          )
        );
      }
      //We can quickly find the correlation for any event we like...
      let firstEvent = tableFor("carrot", JOURNAL);
      let firstEventCorrelation = phi(firstEvent);

      //But there's more we want to do. We want to test every event and get it's correlation
      //This function will grab every unique event. This function takes in a journal array as an argument
      function journalEvents(journal) {
        let events = []; //We initiliaze this array to store our resulting array of each unique event
        /* For each ENTRY in our journal array... */
        for (let entry of journal) {
          /*Then we need to loop each events array wthin each entry */
          for (let event of entry.events) {
            if (!events.includes(event)) {
              /*If the events array DOES NOT include our event?*/
              events.push(event); //ADD (push) the event to our events array!
            }
          }
        }
        return events;
      }
      console.log(journalEvents(JOURNAL));
      //With the journalEvents function, we can grab every single unique event and test it.
      //With this for loop below we can do that!!
      /*for loop: Start with "journalEvents(JOURNAL)", we're checking each unique event, then in the code block we're doing something to each event */
      for (let event of journalEvents(JOURNAL)) {
        /*Start at "tableFor(event, JOURNAL)", we're generating the 4 scenario numbers, then we pass that table to the phi function to get our correlation number!*/
        console.log(event + ":", phi(tableFor(event, JOURNAL)));
      }
    </script>
  </body>
</html>
